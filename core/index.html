<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Core - NNSharp Documentation</title>
  

  <link rel="shortcut icon" href="../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Core";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script>
  <script src="../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> NNSharp Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="..">Overview</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../install/">Installation</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../models/">Models</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../data/">Data structure</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Keras</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../startkeras/">Quick start</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Core</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#fully-connected-dense-layer">Fully connected (Dense layer)</a></li>
                
            
                <li class="toctree-l3"><a href="#flatten">Flatten</a></li>
                
            
                <li class="toctree-l3"><a href="#reshape2d">Reshape2D</a></li>
                
            
                <li class="toctree-l3"><a href="#permute">Permute</a></li>
                
            
                <li class="toctree-l3"><a href="#repeatvector">RepeatVector</a></li>
                
            
                <li class="toctree-l3"><a href="#bias">Bias</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../convolutions/">Convolutions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../pooling/">Pooling</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../activations/">Activations</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../recurrents/">Recurrent layers</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../batchnormalization/">BatchNormalization</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>TensorFlow</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../starttensorflow/">Quick start</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">NNSharp Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Keras &raquo;</li>
        
      
    
    <li>Core</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/adamtiger/NNSharp" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>The core layers contain layers to transform the shape of the input and the fully connected layer as a usual ingridient of a neural network. </p>
<p><span style="float:right;"> <a href="https://github.com/adamtiger/NNSharp/blob/master/NNSharp/Kernels/CPUKernels/Dense2DKernel.cs">[source]</a> </span></p>
<h2 id="fully-connected-dense-layer">Fully connected (Dense layer)</h2>
<p>The structure of <em>Fully connected layer</em> can be seen on the following image:</p>
<p><img alt="dense" src="https://drive.google.com/uc?export=download&amp;id=0B97L9zqg-lnwdUtReFNsTHl4Rlk" /></p>
<p><strong>Input:</strong></p>
<p>A Data2D type with the shape: (1, 1, channels, batches).</p>
<p><strong>Output:</strong></p>
<p>A Data2D type with the shape: (1, 1, units, batches).</p>
<p><strong>Methods:</strong></p>
<p>As it can be seen on the picture this layer uses as many weight vectors (kernels) as many units have the layer. The number of units is equal with the number of output units. The fully connected layer is a linear transformation. A weight multiplies the corresponding input value (blue circle), then the output value (orange circle) is the sum of the previously weighted inputs. For further details see the source code where kernels are used in terms of units.</p>
<p><span style="float:right;"> <a href="https://github.com/adamtiger/NNSharp/blob/master/NNSharp/Kernels/CPUKernels/FlattenKernel.cs">[source]</a> </span></p>
<h2 id="flatten">Flatten</h2>
<p>The <em>Flatten layer</em> creates a 1-dimensional output (array) from the input. </p>
<p><strong>Input:</strong></p>
<p>A Data2D type data with arbitrary shape (rows, columns, channels, batches can be anything).</p>
<p><strong>Output:</strong></p>
<p>A Data2D type data with the following shape: (1, 1, rows * columns * channels, batches). This represents a 1-dimensional vector.</p>
<p><strong>Method:</strong></p>
<p>The mapping occurs in the following way. The <code>batch</code> remains unchanged. For a given <code>batch</code> the reading order is: 1) channel, 2) column, 3) row. Therefore when <code>row</code> and <code>column</code> are fixed, <code>channel</code> is changing. When <code>channel</code> achieves its bound, <code>column</code> is increased while <code>row</code> is still fixed. Then <code>channel</code> is iterated again and so on.</p>
<p><span style="float:right;"> <a href="https://github.com/adamtiger/NNSharp/blob/master/NNSharp/Kernels/CPUKernels/Reshape2DKernel.cs">[source]</a> </span></p>
<h2 id="reshape2d">Reshape2D</h2>
<p>(Next release)</p>
<p>The <em>Reshape2D layer</em> creates an output with the prescribed shape.</p>
<p><strong>Input:</strong></p>
<p>A Data2D type data with arbitrary shape (rows, columns, channels, batches can be anything).</p>
<p><strong>Output:</strong></p>
<p>A Data2D type data with the required (prescribed) shape.</p>
<p><strong>Method:</strong></p>
<p>Reshaping assumes a strict reading order for accessing all of the elements. It has the following priority regarding the dimensions: 1) channel, 2) column, 3) row, 4) batch. If the elements are accessed by this manner, a one dimensional array (let's call it <em>virtual array</em>) will contain all the elements. The algorithm will reshape the original data into a new one that after using the same access method on it, the same virtual array would appear. (The same element in the original and the new data should be mapped to the same place in the virtual array by the access method.)</p>
<p><span style="float:right;"> <a href="https://github.com/adamtiger/NNSharp/blob/master/NNSharp/Kernels/CPUKernels/PermuteKernel.cs">[source]</a> </span></p>
<h2 id="permute">Permute</h2>
<p>(Next release)</p>
<p>The <em>Permute layer</em> creates an output with the same number of elements but the roles of the dimensions are changed.</p>
<p><strong>Input:</strong></p>
<p>A Data2D type data with arbitrary shape (rows, columns, channels, batches can be anything).</p>
<p><strong>Output:</strong></p>
<p>A Data2D type data with permuted shape (new rows, new columns, new channels, batches). The <em>batches can not</em> be changed by permutation. </p>
<p><strong>Method:</strong></p>
<p>Let's suppose that the rows and channels are permuted in the output. Then an element in the input will be written to the permuted places as the example shows:</p>
<pre><code>Indicies in the input: h, w, c, b --&gt; element = input[h, w, c, b].
Then in the output data: output[c, w, h, b] = element.
</code></pre>
<p><span style="float:right;"> <a href="https://github.com/adamtiger/NNSharp/blob/master/NNSharp/Kernels/CPUKernels/RepeatVectorKernel.cs">[source]</a> </span></p>
<h2 id="repeatvector">RepeatVector</h2>
<p>(Next release)</p>
<p>The <em>RepeatVector layer</em> repeats a 1-dimensional vector n times.</p>
<p><strong>Input:</strong></p>
<p>A Data2D type data with shape: (1, 1, channels, batches).</p>
<p><strong>Output:</strong></p>
<p>A Data2D type data with shape: (1, n, channels, batches).</p>
<p><strong>Method:</strong></p>
<p>Repeats the same 1-dimensional input for each channel and batch. </p>
<p><span style="float:right;"> <a href="https://github.com/adamtiger/NNSharp/blob/master/NNSharp/Kernels/CPUKernels/Bias2DKernel.cs#L12">[source]</a> </span></p>
<h2 id="bias">Bias</h2>
<p>The <em>Bias layer</em> adds bias values to the input data. Elements with the same channel are increased by the same bias value. The input and the output shapes <em>are the same</em>.</p>
<p><strong>Input:</strong></p>
<p>A Data2D type data with arbitrary shape (rows, columns, channels, batches can be anything).</p>
<p><strong>Output:</strong></p>
<p>It is the same as the input.</p>
<p><strong>Method:</strong></p>
<p>Adding bias  means the following:</p>
<pre><code>output[h, w, c, b] += input[h, w, c, b] + bias[c]
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../convolutions/" class="btn btn-neutral float-right" title="Convolutions"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../startkeras/" class="btn btn-neutral" title="Quick start"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../startkeras/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../convolutions/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
